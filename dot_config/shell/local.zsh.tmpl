{{- /* Get host-specific data */ -}}
{{- $hostLabel := .hostLabel | default "unknown" -}}
{{- $host := index .hosts $hostLabel | default .default -}}

# ~/.config/shell/local.zsh
# ============================================================================
# HOST-SPECIFIC SHELL CONFIGURATION
# Host: {{ $host.label }} | OS: {{ $host.os }} | Theme: {{ $host.theme }}
# Generated by chezmoi - do not edit directly
# ============================================================================

# Host identity (available to scripts/prompts)
export DOT_HOST="{{ $host.label }}"
export DOT_THEME="{{ $host.theme }}"
export DOT_OS="{{ $host.os }}"

# ============================================================================
# OS-SPECIFIC PATH ADJUSTMENTS
# ============================================================================
{{ if eq $host.os "macos" -}}
# macOS: Homebrew paths
if [[ -d /opt/homebrew ]]; then
    eval "$(/opt/homebrew/bin/brew shellenv)"
elif [[ -d /usr/local/Homebrew ]]; then
    eval "$(/usr/local/Homebrew/bin/brew shellenv)"
fi

# macOS-specific paths
export PATH="$HOME/.local/bin:$PATH"
{{ else if eq $host.os "arch" -}}
# Arch Linux paths
export PATH="$HOME/.local/bin:$PATH"
export PATH="$HOME/.cargo/bin:$PATH"
{{ else if eq $host.os "ubuntu" -}}
# Ubuntu paths
export PATH="$HOME/.local/bin:$PATH"
export PATH="$HOME/.cargo/bin:$PATH"

# Snap if present
[[ -d /snap/bin ]] && export PATH="/snap/bin:$PATH"
{{ end -}}

# ============================================================================
# CLIPBOARD FUNCTION (OS-specific)
# ============================================================================
{{ if eq $host.os "macos" -}}
# macOS clipboard
clip() {
    if [[ -p /dev/stdin ]]; then
        pbcopy
    else
        pbcopy < "$1"
    fi
}

paste() {
    pbpaste
}
{{ else -}}
# Linux clipboard (prefer wl-copy for Wayland, fall back to xclip)
clip() {
    if [[ -n "$WAYLAND_DISPLAY" ]]; then
        if [[ -p /dev/stdin ]]; then
            wl-copy
        else
            wl-copy < "$1"
        fi
    else
        if [[ -p /dev/stdin ]]; then
            xclip -selection clipboard
        else
            xclip -selection clipboard < "$1"
        fi
    fi
}

paste() {
    if [[ -n "$WAYLAND_DISPLAY" ]]; then
        wl-paste
    else
        xclip -selection clipboard -o
    fi
}
{{ end -}}

# ============================================================================
# OS-SPECIFIC ALIASES
# ============================================================================
{{ if eq $host.os "macos" -}}
# macOS-specific
alias flush-dns='sudo dscacheutil -flushcache; sudo killall -HUP mDNSResponder'
alias show-hidden='defaults write com.apple.finder AppleShowAllFiles YES; killall Finder'
alias hide-hidden='defaults write com.apple.finder AppleShowAllFiles NO; killall Finder'
alias update='brew update && brew upgrade'
{{ else if eq $host.os "arch" -}}
# Arch-specific
alias update='sudo pacman -Syu'
alias install='sudo pacman -S'
alias remove='sudo pacman -Rns'
alias search='pacman -Ss'
alias cleanup='sudo pacman -Rns $(pacman -Qtdq)'
{{ if ne (env "USER") "root" -}}
# yay aliases (if installed)
if command -v yay &> /dev/null; then
    alias yup='yay -Syu'
    alias yin='yay -S'
fi
{{ end -}}
{{ else if eq $host.os "ubuntu" -}}
# Ubuntu-specific
alias update='sudo apt update && sudo apt upgrade'
alias install='sudo apt install'
alias remove='sudo apt remove'
alias search='apt search'
alias cleanup='sudo apt autoremove'
{{ end -}}

# ============================================================================
# OPEN COMMAND (OS-specific)
# ============================================================================
{{ if eq $host.os "macos" -}}
# macOS has 'open' built-in
{{ else -}}
# Linux: alias open to xdg-open
alias open='xdg-open'
{{ end -}}

# ============================================================================
# HOST-SPECIFIC CUSTOM SETTINGS
# ============================================================================
# Add any machine-specific settings below this line
# (This section can be customized per host if needed)
